# 材质管理器使用说明

## 功能概述

材质管理器是一个独立的SketchUp插件功能，用于读取和管理SketchUp材质目录中的材质文件。它提供了直观的菜单界面，让用户可以方便地浏览和应用材质。

## 主要特性

- **自动扫描材质目录**：自动读取指定目录下的材质分类和材质文件
- **中文菜单界面**：自动将英文材质分类名称翻译为中文显示
- **层级菜单结构**：按材质分类文件夹组织菜单，清晰易用
- **材质预览和应用**：点击材质即可应用到选中的对象
- **实时刷新**：支持手动刷新材质目录
- **翻译对照表**：提供中英文分类名称对照表查看
- **错误处理**：完善的错误处理和用户提示

## 安装和配置

### 系统要求
- SketchUp 2024 或更高版本
- Windows 操作系统
- 材质目录路径：`C:\ProgramData\SketchUp\SketchUp 2024\SketchUp\Materials`

### 目录结构要求
材质目录应该按以下结构组织：
```
Materials/
├── 分类1/
│   ├── 材质1.skm
│   ├── 材质2.skm
│   └── ...
├── 分类2/
│   ├── 材质A.skm
│   ├── 材质B.skm
│   └── ...
└── ...
```

## 使用方法

### 1. 启动材质管理器
- 插件启动后，材质管理器会自动初始化
- 在SketchUp的"Extensions"菜单下会出现"材质管理器"子菜单

### 2. 浏览材质
- 点击"Extensions" → "材质管理器"
- 菜单会显示所有可用的材质分类
- 每个分类下显示该类别包含的所有材质

### 3. 应用材质
1. **选择对象**：在SketchUp中选择要应用材质的对象（面、组、组件等）
2. **点击材质**：在材质管理器中点击想要应用的材质
3. **确认应用**：系统会显示应用成功的消息

### 4. 刷新材质目录
- 如果添加了新的材质文件，可以点击"刷新材质目录"
- 系统会重新扫描目录并更新菜单

### 5. 查看翻译对照表
- 点击"查看翻译对照表"可以查看中英文分类名称对照
- 显示翻译统计信息，包括翻译率和未翻译的分类

## 菜单结构

```
Extensions
└── 材质管理器
    ├── 刷新材质目录
    ├── 查看翻译对照表
    ├── 建筑
    │   ├── 混凝土
    │   ├── 砖石
    │   └── 木材
    ├── 金属
    │   ├── 钢
    │   ├── 铝
    │   └── 铜
    └── 玻璃
        ├── 透明玻璃
        ├── 磨砂玻璃
        └── 彩色玻璃
```

## 支持的文件格式

- **主要格式**：`.skm` (SketchUp材质文件)
- **材质名称**：自动提取文件名（不包含扩展名）

## 中文翻译功能

### 自动翻译
材质管理器会自动将英文的材质分类名称翻译为中文显示，提供更友好的中文界面。

### 支持的翻译分类
- **建筑类**：Architectural → 建筑
- **砖石类**：Brick and Cladding → 砖石和覆层
- **金属类**：Metal → 金属
- **木材类**：Wood → 木材
- **玻璃类**：Glass → 玻璃
- **混凝土类**：Concrete → 混凝土
- **陶瓷类**：Ceramic → 陶瓷
- **织物类**：Fabric → 织物
- **涂料类**：Paint → 涂料
- **塑料类**：Plastic → 塑料
- **石材类**：Stone → 石材
- **瓷砖类**：Tile → 瓷砖
- **地毯类**：Carpet → 地毯
- **屋顶类**：Roofing → 屋顶
- **地面类**：Flooring → 地面
- **景观类**：Landscape → 景观

### 翻译统计
- 查看翻译对照表功能显示翻译统计信息
- 包括总分类数、已翻译数、未翻译数和翻译率
- 帮助用户了解翻译覆盖情况

## 错误处理

### 常见问题及解决方案

1. **材质目录不存在**
   - 检查路径是否正确：`C:\ProgramData\SketchUp\SketchUp 2024\SketchUp\Materials`
   - 确认SketchUp安装完整

2. **材质加载失败**
   - 检查材质文件是否损坏
   - 确认文件权限设置正确

3. **菜单创建失败**
   - 检查插件是否正确加载
   - 查看控制台错误信息

## 技术特性

### 性能优化
- 材质分类缓存机制
- 按需加载材质文件
- 智能错误处理和恢复

### 兼容性
- 与现有工厂布局导入功能完全独立
- 不影响其他插件的正常运行
- 支持SketchUp 2024及以上版本

## 注意事项

1. **材质应用前必须选择对象**：如果没有选择对象，系统会提示用户先选择
2. **材质文件路径**：确保材质文件路径不包含特殊字符
3. **权限要求**：需要读取材质目录的权限
4. **内存管理**：大量材质文件可能影响性能，建议定期清理不需要的材质

## 故障排除

### 如果材质管理器没有显示
1. 检查插件是否正确加载
2. 查看控制台输出信息
3. 确认材质目录路径是否正确
4. 尝试重启SketchUp

### 如果材质无法应用
1. 确认已选择对象
2. 检查材质文件是否完整
3. 查看错误提示信息
4. 尝试刷新材质目录

## 更新日志

- **v1.0**：初始版本，支持基本的材质读取和应用功能
- 自动材质分类识别
- 层级菜单结构
- 材质应用功能
- 错误处理和用户提示 