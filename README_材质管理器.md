# 材质管理器 - SketchUp插件

## 简介

材质管理器是一个专为SketchUp设计的插件，能够自动读取SketchUp材质目录中的分类材质，并提供直观的层级菜单界面来应用材质到选中的对象。

## 功能特点

✨ **自动材质扫描** - 自动读取SketchUp材质目录  
📁 **分类管理** - 按文件夹分类组织材质  
🇨🇳 **中文界面** - 自动翻译英文分类名称为中文  
🎨 **一键应用** - 点击即可应用材质到选中对象  
🔄 **实时刷新** - 支持手动刷新材质目录  
📊 **翻译统计** - 提供翻译对照表和统计信息  
🛡️ **错误处理** - 完善的错误处理和用户提示  
🔧 **独立运行** - 不影响其他插件功能  

## 系统要求

- **操作系统**: Windows 10/11
- **SketchUp版本**: 2024 或更高版本
- **材质目录**: `C:\ProgramData\SketchUp\SketchUp 2024\SketchUp\Materials`

## 安装方法

### 方法1：直接使用（推荐）
1. 确保您的SketchUp已安装并包含材质库
2. 将整个项目文件夹复制到SketchUp插件目录
3. 重启SketchUp
4. 在"Extensions"菜单下找到"材质管理器"

### 方法2：手动安装
1. 将 `lib/material_manager.rb` 文件复制到您的SketchUp插件目录
2. 在SketchUp中运行以下代码：
```ruby
load 'path/to/material_manager.rb'
MaterialManager.init
```

## 使用方法

### 基本操作流程

1. **启动插件**
   - 插件启动后会自动初始化
   - 在"Extensions"菜单下出现"材质管理器"

2. **浏览材质**
   - 点击"Extensions" → "材质管理器"
   - 查看按分类组织的材质列表

3. **应用材质**
   - 在SketchUp中选择要应用材质的对象
   - 在材质管理器中点击想要应用的材质
   - 确认应用成功

4. **刷新材质**
   - 如果添加了新材质，点击"刷新材质目录"

### 菜单结构示例

```
Extensions
└── 材质管理器
    ├── 刷新材质目录
    ├── 建筑
    │   ├── 混凝土
    │   ├── 砖石
    │   └── 木材
    ├── 金属
    │   ├── 钢
    │   ├── 铝
    │   └── 铜
    └── 玻璃
        ├── 透明玻璃
        ├── 磨砂玻璃
        └── 彩色玻璃
```

## 目录结构要求

您的材质目录应该按以下结构组织：

```
Materials/
├── 分类1/
│   ├── 材质1.skm
│   ├── 材质2.skm
│   └── ...
├── 分类2/
│   ├── 材质A.skm
│   ├── 材质B.skm
│   └── ...
└── ...
```

## 支持的文件格式

- **主要格式**: `.skm` (SketchUp材质文件)
- **材质名称**: 自动提取文件名（不包含扩展名）

## 中文翻译功能

### 自动翻译
材质管理器会自动将英文的材质分类名称翻译为中文显示，提供更友好的中文界面。

### 支持的翻译分类
- **建筑类**：Architectural → 建筑
- **砖石类**：Brick and Cladding → 砖石和覆层
- **金属类**：Metal → 金属
- **木材类**：Wood → 木材
- **玻璃类**：Glass → 玻璃
- **混凝土类**：Concrete → 混凝土
- **陶瓷类**：Ceramic → 陶瓷
- **织物类**：Fabric → 织物
- **涂料类**：Paint → 涂料
- **塑料类**：Plastic → 塑料
- **石材类**：Stone → 石材
- **瓷砖类**：Tile → 瓷砖
- **地毯类**：Carpet → 地毯
- **屋顶类**：Roofing → 屋顶
- **地面类**：Flooring → 地面
- **景观类**：Landscape → 景观

### 翻译统计
- 查看翻译对照表功能显示翻译统计信息
- 包括总分类数、已翻译数、未翻译数和翻译率
- 帮助用户了解翻译覆盖情况

## 常见问题

### Q: 材质管理器菜单没有显示？
A: 请检查：
- SketchUp版本是否为2024或更高
- 材质目录路径是否正确
- 插件是否正确加载

### Q: 无法应用材质？
A: 请确认：
- 已选择要应用材质的对象
- 材质文件是否完整
- 是否有足够的权限

### Q: 材质分类显示不正确？
A: 请检查：
- 材质目录结构是否正确
- 文件夹名称是否包含特殊字符
- 尝试刷新材质目录

## 故障排除

### 1. 检查控制台输出
在SketchUp中查看控制台（Window → Ruby Console）的错误信息

### 2. 验证材质目录
确认路径 `C:\ProgramData\SketchUp\SketchUp 2024\SketchUp\Materials` 存在

### 3. 检查文件权限
确保有读取材质目录的权限

### 4. 重启SketchUp
有时候重启可以解决加载问题

## 技术特性

- **性能优化**: 材质分类缓存机制
- **错误处理**: 智能错误处理和恢复
- **兼容性**: 与现有功能完全独立
- **扩展性**: 支持自定义材质目录

## 更新日志

### v1.0 (当前版本)
- ✅ 自动材质分类识别
- ✅ 中文菜单界面（自动翻译）
- ✅ 层级菜单结构
- ✅ 材质应用功能
- ✅ 翻译对照表查看
- ✅ 翻译统计信息
- ✅ 错误处理和用户提示
- ✅ 材质目录刷新功能

## 贡献

如果您发现bug或有改进建议，请：
1. 检查现有问题列表
2. 创建新的问题报告
3. 提供详细的错误信息和重现步骤

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目Issues页面
- 邮箱：[您的邮箱]

---

**注意**: 此插件需要SketchUp环境才能正常运行。在普通Ruby环境中运行可能无法正常工作。 