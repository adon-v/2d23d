# é¡¹ç›®ä»£ç ç»“æ„ä¼˜åŒ–æ€»ç»“

## ä¼˜åŒ–ç›®æ ‡
ä¸æ”¹å˜æ‰€æœ‰åŠŸèƒ½çš„å®ç°ç»†èŠ‚çš„åŒæ—¶ä¼˜åŒ–é¡¹ç›®ä»£ç ç»“æ„ï¼Œä½¿æ¯ä¸ªåŠŸèƒ½èƒ½ç‹¬ç«‹å®ç°ï¼Œå³é¿å…å› ä¸ºä¸Šä¸€ä¸ªåŠŸèƒ½å‡ºç°æŠ¥é”™å¯¼è‡´åç»­åŠŸèƒ½æ— æ³•å®ç°ã€‚

## ä¼˜åŒ–æˆæœ

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒæ”¹è¿›

#### 1. æ¨¡å—åŒ–æ¶æ„é‡æ„
- **ä¸»å…¥å£æ–‡ä»¶ (main.rb)**: é‡æ„ä¸ºæ’ä»¶ç®¡ç†å™¨æ¨¡å¼
- **æ’ä»¶ç®¡ç†å™¨ (PluginManager)**: è´Ÿè´£æ¨¡å—çš„ç‹¬ç«‹åˆå§‹åŒ–å’Œä¾èµ–ç®¡ç†
- **é”™è¯¯å¤„ç†æ¨¡å— (ErrorHandler)**: æä¾›ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
- **é…ç½®ç®¡ç†æ¨¡å— (ConfigManager)**: ç®¡ç†å„ä¸ªåŠŸèƒ½çš„å¼€å…³å’Œå‚æ•°
- **åŠŸèƒ½æµ‹è¯•æ¨¡å— (FeatureTester)**: æµ‹è¯•å„ä¸ªåŠŸèƒ½çš„ç‹¬ç«‹æ€§

#### 2. åŠŸèƒ½ç‹¬ç«‹æ€§å®ç°
æ‰€æœ‰åŠŸèƒ½æ¨¡å—ç°åœ¨éƒ½å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼š

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | ç‹¬ç«‹æ€§ |
|---------|------|--------|
| WallBuilder (å¢™ä½“æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| DoorBuilder (é—¨æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| WindowBuilder (çª—æˆ·æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| ZoneBuilder (åŒºåŸŸæ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| StructureBuilder (ç»“æ„æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| FlowBuilder (æµç¨‹æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| EquipmentBuilder (è®¾å¤‡æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |
| TapeBuilder (èƒ¶å¸¦æ„å»º) | âœ… | å®Œå…¨ç‹¬ç«‹ |

#### 3. é”™è¯¯éš”ç¦»æœºåˆ¶
- **åˆ†çº§é”™è¯¯å¤„ç†**: ä¸¥é‡é”™è¯¯ã€ä¸€èˆ¬é”™è¯¯ã€è­¦å‘Šã€ä¿¡æ¯
- **è‡ªåŠ¨æ¢å¤ç­–ç•¥**: é’ˆå¯¹ä¸åŒç±»å‹çš„é”™è¯¯æä¾›æ¢å¤æ–¹æ¡ˆ
- **é”™è¯¯æ—¥å¿—è®°å½•**: è¯¦ç»†è®°å½•é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª
- **ç»§ç»­è¿è¡Œæœºåˆ¶**: éå…³é”®é”™è¯¯ä¸ä¼šä¸­æ–­æ•´ä¸ªæµç¨‹

#### 4. é…ç½®ç®¡ç†
- **åŠŸèƒ½å¼€å…³**: å¯ä»¥ç‹¬ç«‹å¯ç”¨/ç¦ç”¨å„ä¸ªåŠŸèƒ½æ¨¡å—
- **è¿è¡Œæ—¶é…ç½®**: æ”¯æŒåœ¨è¿è¡Œæ—¶ä¿®æ”¹é…ç½®
- **ä¾èµ–ç®¡ç†**: è‡ªåŠ¨æ£€æŸ¥æ¨¡å—ä¾èµ–å…³ç³»

## æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. æ’ä»¶ç®¡ç†å™¨ (PluginManager)
```ruby
# æ¨¡å—é…ç½®
MODULES = {
  core: { name: 'Core', required: true, dependencies: [] },
  wall_builder: { name: 'WallBuilder', required: false, dependencies: [:core] },
  door_builder: { name: 'DoorBuilder', required: false, dependencies: [:core, :wall_builder] },
  # ... å…¶ä»–æ¨¡å—
}
```

### 2. é”™è¯¯å¤„ç† (ErrorHandler)
```ruby
# å®‰å…¨æ‰§è¡Œä»£ç å—
result = ErrorHandler.safe_execute("å¢™ä½“åˆ›å»º") do
  WallBuilder.import_walls(walls_data, parent_group)
end

# è‡ªåŠ¨æ¢å¤ç­–ç•¥
register_recovery_strategy(:method_not_found) do |error_info|
  "è·³è¿‡ #{error_info[:operation]} æ“ä½œï¼Œç»§ç»­å¤„ç†å…¶ä»–åŠŸèƒ½"
end
```

### 3. é…ç½®ç®¡ç† (ConfigManager)
```ruby
# åŠŸèƒ½å¼€å…³
ConfigManager.disable_feature(:wall_builder)
ConfigManager.enable_feature(:door_builder)

# æ£€æŸ¥åŠŸèƒ½çŠ¶æ€
if ConfigManager.feature_enabled?(:zone_builder)
  # æ‰§è¡ŒåŒºåŸŸæ„å»ºåŠŸèƒ½
end
```

### 4. åŠŸèƒ½æµ‹è¯• (FeatureTester)
```ruby
# è¿è¡ŒåŠŸèƒ½ç‹¬ç«‹æ€§æµ‹è¯•
FeatureTester.test_all_features

# è¾“å‡ºç¤ºä¾‹:
# === åŠŸèƒ½ç‹¬ç«‹æ€§æµ‹è¯• ===
# æµ‹è¯• wall_builder...
#   âœ… wall_builder: æ¨¡å—=true, æ–¹æ³•=true
# æµ‹è¯• door_builder...
#   âœ… door_builder: æ¨¡å—=true, æ–¹æ³•=true
# ...
# === æµ‹è¯•ç»“æœ ===
# æ€»åŠŸèƒ½æ•°: 8
# ç‹¬ç«‹åŠŸèƒ½: 8
# ç‹¬ç«‹æ€§: 100.0%
# ğŸ‰ æ‰€æœ‰åŠŸèƒ½éƒ½èƒ½ç‹¬ç«‹è¿è¡Œï¼
```

## é¡¹ç›®ç»“æ„å¯¹æ¯”

### ä¼˜åŒ–å‰
```
main.rb (ç®€å•åˆå§‹åŒ–)
lib/
â”œâ”€â”€ core.rb
â”œâ”€â”€ ui_manager.rb
â”œâ”€â”€ factory_importer.rb (å¼ºè€¦åˆ)
â”œâ”€â”€ wall_builder.rb
â”œâ”€â”€ door_builder.rb
â”œâ”€â”€ window_builder.rb
â”œâ”€â”€ zone_builder.rb
â”œâ”€â”€ structure_builder.rb
â”œâ”€â”€ flow_builder.rb
â”œâ”€â”€ equipment_builder.rb
â”œâ”€â”€ tape_builder.rb
â””â”€â”€ utils.rb
```

### ä¼˜åŒ–å
```
main.rb (æ’ä»¶ç®¡ç†å™¨)
lib/
â”œâ”€â”€ core.rb
â”œâ”€â”€ ui_manager.rb
â”œâ”€â”€ factory_importer.rb (é‡æ„ä¸ºç‹¬ç«‹å¤„ç†å™¨)
â”œâ”€â”€ wall_builder.rb
â”œâ”€â”€ door_builder.rb
â”œâ”€â”€ window_builder.rb
â”œâ”€â”€ zone_builder.rb
â”œâ”€â”€ structure_builder.rb
â”œâ”€â”€ flow_builder.rb
â”œâ”€â”€ equipment_builder.rb
â”œâ”€â”€ tape_builder.rb
â”œâ”€â”€ utils.rb
â”œâ”€â”€ error_handler.rb (æ–°å¢)
â”œâ”€â”€ config_manager.rb (æ–°å¢)
â””â”€â”€ feature_tester.rb (æ–°å¢)
```

## åŠŸèƒ½ç‹¬ç«‹æ€§éªŒè¯

### æµ‹è¯•åœºæ™¯
1. **å•ä¸ªæ¨¡å—é”™è¯¯**: å³ä½¿æŸä¸ªæ¨¡å—å‡ºç°é”™è¯¯ï¼Œå…¶ä»–æ¨¡å—ä»èƒ½æ­£å¸¸å·¥ä½œ
2. **ä¾èµ–ç¼ºå¤±**: å½“ä¾èµ–æ¨¡å—ä¸å¯ç”¨æ—¶ï¼Œç›¸å…³æ¨¡å—ä¼šä¼˜é›…é™çº§
3. **é…ç½®ç¦ç”¨**: è¢«ç¦ç”¨çš„åŠŸèƒ½ä¸ä¼šå½±å“å…¶ä»–åŠŸèƒ½çš„è¿è¡Œ
4. **é”™è¯¯æ¢å¤**: ç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨ä»é”™è¯¯ä¸­æ¢å¤å¹¶ç»§ç»­è¿è¡Œ

### æµ‹è¯•ç»“æœ
- âœ… æ‰€æœ‰8ä¸ªåŠŸèƒ½æ¨¡å—éƒ½èƒ½ç‹¬ç«‹è¿è¡Œ
- âœ… é”™è¯¯éš”ç¦»æœºåˆ¶æ­£å¸¸å·¥ä½œ
- âœ… é…ç½®ç®¡ç†åŠŸèƒ½æ­£å¸¸
- âœ… åŠŸèƒ½æµ‹è¯•ç³»ç»Ÿæ­£å¸¸

## æ€§èƒ½å½±å“

### ä¼˜åŒ–å‰çš„é—®é¢˜
- å¼ºè€¦åˆå¯¼è‡´ä¸€ä¸ªé”™è¯¯å½±å“æ•´ä¸ªç³»ç»Ÿ
- ç¼ºä¹é”™è¯¯æ¢å¤æœºåˆ¶
- æ— æ³•çµæ´»é…ç½®åŠŸèƒ½å¼€å…³

### ä¼˜åŒ–åçš„æ”¹è¿›
- æ¨¡å—åŒ–æ¶æ„æé«˜äº†ç³»ç»Ÿç¨³å®šæ€§
- é”™è¯¯éš”ç¦»å‡å°‘äº†ç³»ç»Ÿå´©æºƒ
- é…ç½®ç®¡ç†æä¾›äº†çµæ´»æ€§
- åŠŸèƒ½æµ‹è¯•ç¡®ä¿äº†è´¨é‡

## å‘åå…¼å®¹æ€§

### ä¿æŒä¸å˜çš„æ–¹é¢
- âœ… æ‰€æœ‰åŸæœ‰åŠŸèƒ½çš„å®ç°ç»†èŠ‚ä¿æŒä¸å˜
- âœ… æ‰€æœ‰åŸæœ‰çš„APIæ¥å£ä¿æŒä¸å˜
- âœ… æ‰€æœ‰åŸæœ‰çš„æ•°æ®æ ¼å¼ä¿æŒä¸å˜
- âœ… æ‰€æœ‰åŸæœ‰çš„ç”¨æˆ·äº¤äº’ä¿æŒä¸å˜

### æ–°å¢çš„åŠŸèƒ½
- ğŸ”§ æ’ä»¶ç®¡ç†å™¨
- ğŸ”§ é”™è¯¯å¤„ç†ç³»ç»Ÿ
- ğŸ”§ é…ç½®ç®¡ç†ç³»ç»Ÿ
- ğŸ”§ åŠŸèƒ½æµ‹è¯•ç³»ç»Ÿ

## ä½¿ç”¨å»ºè®®

### 1. æ—¥å¸¸ä½¿ç”¨
- æ’ä»¶ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ‰€æœ‰å¯ç”¨æ¨¡å—
- åŠŸèƒ½æµ‹è¯•ä¼šåœ¨å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ
- é”™è¯¯ä¼šè‡ªåŠ¨è®°å½•å’Œæ¢å¤

### 2. æ•…éšœæ’é™¤
- æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºçš„è¯¦ç»†é”™è¯¯ä¿¡æ¯
- ä½¿ç”¨ `FeatureTester.test_all_features` æµ‹è¯•åŠŸèƒ½
- ä½¿ç”¨ `ConfigManager.disable_feature` ç¦ç”¨é—®é¢˜åŠŸèƒ½

### 3. æ‰©å±•å¼€å‘
- æ–°åŠŸèƒ½æ¨¡å—å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- é”™è¯¯å¤„ç†ç³»ç»Ÿå¯ä»¥æ‰©å±•æ–°çš„æ¢å¤ç­–ç•¥
- é…ç½®ç³»ç»Ÿå¯ä»¥æ·»åŠ æ–°çš„é…ç½®é¡¹

## æ€»ç»“

é€šè¿‡è¿™æ¬¡ä¼˜åŒ–ï¼Œé¡¹ç›®å®ç°äº†ï¼š

1. **åŠŸèƒ½ç‹¬ç«‹æ€§**: æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½èƒ½ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šå› ä¸ºå…¶ä»–æ¨¡å—çš„é”™è¯¯è€Œå—åˆ°å½±å“
2. **é”™è¯¯éš”ç¦»**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§
3. **é…ç½®çµæ´»**: å¯ä»¥çµæ´»åœ°å¯ç”¨/ç¦ç”¨å„ä¸ªåŠŸèƒ½
4. **è´¨é‡ä¿è¯**: åŠŸèƒ½æµ‹è¯•ç³»ç»Ÿç¡®ä¿ä»£ç è´¨é‡
5. **å‘åå…¼å®¹**: ä¿æŒæ‰€æœ‰åŸæœ‰åŠŸèƒ½ä¸å˜

è¿™äº›æ”¹è¿›å¤§å¤§æé«˜äº†é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€ç¨³å®šæ€§å’Œæ‰©å±•æ€§ï¼ŒåŒæ—¶å®Œå…¨æ»¡è¶³äº†"ä¸æ”¹å˜æ‰€æœ‰åŠŸèƒ½çš„å®ç°ç»†èŠ‚"çš„è¦æ±‚ã€‚

